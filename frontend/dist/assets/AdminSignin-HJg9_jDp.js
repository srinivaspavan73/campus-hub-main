import{u as N,r as o,a as E,j as e,L as k}from"./index-oRpEOpm0.js";import{a as A}from"./axios-upsvKRUO.js";import{a as C}from"./adminAtom-DU_baGDi.js";function L(){const u=N(),[t,w]=o.useState({email:"",password:""}),[a,x]=o.useState({}),[p,g]=o.useState(!1),[h,l]=o.useState(""),[m,y]=o.useState(!1),j=E(C);o.useEffect(()=>{localStorage.getItem("token")&&u("/admin/dashboard")},[]);const b=s=>{const{name:n,value:d}=s.target;w(i=>({...i,[n]:d})),a[n]&&x(i=>({...i,[n]:""}))},v=()=>{const s={};return t.email?/\S+@\S+\.\S+/.test(t.email)||(s.email="Email is invalid"):s.email="Email is required",t.password||(s.password="Password is required"),x(s),Object.keys(s).length===0},S=async s=>{var n,d,i,f;if(s.preventDefault(),!!v()){g(!0),l("");try{const r=t.email.trim().toLowerCase(),c=await A.post("https://campushub-api.vercel.app/admin/signin",{email:r,password:t.password});c.data.success&&(localStorage.setItem("token",c.data.token),j(c.data.admin),u("/admin/dashboard"))}catch(r){console.error("Admin signin error:",r),(d=(n=r.response)==null?void 0:n.data)!=null&&d.msg?l(r.response.data.msg):(f=(i=r.response)==null?void 0:i.data)!=null&&f.errors?l(r.response.data.errors.join(", ")):l("An error occurred during sign in. Please try again.")}finally{g(!1)}}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 p-6",children:e.jsxs("div",{className:"w-full max-w-md bg-gray-800 p-8 rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-white text-center",children:"CampusHub"}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-300 text-center",children:"Admin Portal"}),e.jsx("p",{className:"mt-2 text-sm text-gray-400 text-center",children:"Authorized personnel only"}),h&&e.jsx("div",{className:"mt-4 p-3 bg-red-900 border border-red-700 text-red-100 rounded text-center",children:h}),e.jsxs("form",{className:"mt-6 space-y-4",onSubmit:S,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Email address"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:b,className:`w-full mt-1 px-4 py-2 rounded-md bg-gray-700 text-white border ${a.email?"border-red-500":"border-gray-600"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"admin@example.com"}),a.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{type:m?"text":"password",name:"password",value:t.password,onChange:b,className:`w-full px-4 py-2 rounded-md bg-gray-700 text-white border ${a.password?"border-red-500":"border-gray-600"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-3 flex items-center text-gray-400",onClick:()=>y(!m),children:m?"ğŸ™ˆ":"ğŸ‘ï¸"})]}),a.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.password})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full py-2 rounded-md bg-blue-600 text-white font-semibold hover:bg-blue-700 transition focus:outline-none focus:ring-2 focus:ring-blue-500",children:p?"Signing in...":"Admin Sign In"})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-400",children:["Return to ",e.jsx(k,{to:"/",className:"text-blue-400 hover:text-blue-300",children:"main site"})]})]})})}export{L as default};
